generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/@prisma/client-academic"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

model Ciclo {
  id          Int          @id @default(autoincrement())
  numero      Int
  estudiantes Estudiante[]
  
  @@map("ciclos")
}

model Carrera {
  id          Int          @id @default(autoincrement())
  nombre      String       @unique
  docentes    Docente[]
  estudiantes Estudiante[]
  materias    Materia[]
  
  @@map("carreras")
}

model Estudiante {
  id        Int       @id @default(autoincrement())
  nombre    String
  email     String    @unique
  carreraId Int
  cicloId   Int
  estado    String    @default("ACTIVO") // Para "Listar todos los estudiantes activos"
  carrera   Carrera   @relation(fields: [carreraId], references: [id])
  ciclo     Ciclo     @relation(fields: [cicloId], references: [id])
  materias  Materia[] @relation("Inscripciones")
  
  @@map("estudiantes")
}

model Materia {
  id          Int          @id @default(autoincrement())
  nombre      String
  codigo      String       @unique
  cupos       Int          @default(30) // Para control de cupos en transacción
  docenteId   Int
  carreraId   Int
  carrera     Carrera      @relation(fields: [carreraId], references: [id])
  docente     Docente      @relation(fields: [docenteId], references: [id])
  estudiantes Estudiante[] @relation("Inscripciones")
  
  @@map("materias")
}

model Docente {
  id           Int       @id @default(autoincrement())
  nombre       String
  email        String    @unique
  tipoContrato String    @default("TIEMPO_COMPLETO") // Para "Filtrar docentes que sean de tiempo completo"
  estado       String    @default("ACTIVO") // Para "No estén inactivos"
  carreraId    Int
  carrera      Carrera   @relation(fields: [carreraId], references: [id])
  materias     Materia[]
  
  @@map("docentes")
}
